<mah:MetroWindow x:Class="FathomOS.Modules.RovGyroCalibration.Views.HelpWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        Title="ROV Gyro Calibration - User Guide"
        Height="750" Width="950"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        BorderBrush="{DynamicResource AccentBrush}"
        BorderThickness="1"
        GlowBrush="{DynamicResource AccentBrush}"
        ResizeMode="CanResizeWithGrip"
        TitleCharacterCasing="Normal">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{DynamicResource HeaderBrush}" Padding="20">
            <StackPanel>
                <TextBlock Text="ðŸ“– User Guide" FontSize="24" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                <TextBlock Text="ROV Gyro Calibration Module - 7 Steps to Survey Excellence"
                           FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="20">
            <StackPanel>
                <!-- Overview -->
                <Border Style="{DynamicResource CardBorder}" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="Overview" FontSize="18" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,10"/>
                        <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" LineHeight="24">
                            This module performs ROV gyro calibration or verification following Subsea7's GLSIFR0034 procedure.
                            It calculates the C-O (Calculated minus Observed) offset between a reference heading system 
                            (Vessel Gyro) and the ROV's gyro system, accounting for the geometric relationship between 
                            vessel and ROV.
                        </TextBlock>
                        <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,10,0,0" LineHeight="24">
                            <Bold>Key Concept:</Bold> ROV Calculated Heading = Vessel Heading + D + Î¸ + Facing Direction Offset
                            <LineBreak/>Where D = Dead reckoning offset, Î¸ = Baseline angle from USBL
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Step 1 -->
                <Border Style="{DynamicResource CardBorder}" Margin="0,0,0,15">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Ellipse Width="28" Height="28" Fill="{DynamicResource AccentBrush}"/>
                            <TextBlock Text="1" FontSize="14" FontWeight="Bold" Foreground="White" 
                                       Margin="-19,5,0,0"/>
                            <TextBlock Text="Setup &amp; Configure" FontSize="16" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" Margin="10,3,0,0"/>
                        </StackPanel>
                        <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" LineHeight="24">
                            <Bold>User Input:</Bold>
                            <LineBreak/>â€¢ Select Calibration or Verification mode
                            <LineBreak/>â€¢ Enter Project Name, Vessel Name, ROV Name (all required)
                            <LineBreak/>â€¢ Configure ROV Setup:
                            <LineBreak/>  - ROV Facing Direction (Forward/Aft/Port/Starboard)
                            <LineBreak/>  - Baseline Side (Port/Starboard/Forward/Aft)
                            <LineBreak/>  - Baseline Orientation (Parallel/Perpendicular)
                            <LineBreak/>  - Dead Reckoning offset (D)
                            <LineBreak/>â€¢ Select Display Unit
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Step 2 -->
                <Border Style="{DynamicResource CardBorder}" Margin="0,0,0,15">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Ellipse Width="28" Height="28" Fill="{DynamicResource AccentBrush}"/>
                            <TextBlock Text="2" FontSize="14" FontWeight="Bold" Foreground="White" 
                                       Margin="-19,5,0,0"/>
                            <TextBlock Text="Import Data" FontSize="16" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" Margin="10,3,0,0"/>
                        </StackPanel>
                        <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" LineHeight="24">
                            <Bold>User Input:</Bold>
                            <LineBreak/>â€¢ Browse and select NPD or CSV data file
                            <LineBreak/>â€¢ Use time filter to select data range (Start Time / End Time)
                            <LineBreak/>
                            <LineBreak/><Bold>Expected File Format:</Bold>
                            <LineBreak/>The file should contain columns for:
                            <LineBreak/>â€¢ Timestamp (Date/Time)
                            <LineBreak/>â€¢ Vessel Heading (from vessel gyro)
                            <LineBreak/>â€¢ ROV Heading (from ROV gyro)
                            <LineBreak/>â€¢ USBL Baseline Angle (Î¸)
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Step 3-7 summarized -->
                <Border Style="{DynamicResource CardBorder}" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="Steps 3-7: Process, Analyze, Validate, Export" FontSize="16" FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,10"/>
                        <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" LineHeight="24">
                            <Bold>Step 3 - Configure:</Bold> Set QC criteria and sigma factor
                            <LineBreak/><Bold>Step 4 - Process:</Bold> Calculate C-O with geometric correction
                            <LineBreak/><Bold>Step 5 - Analyze:</Bold> Review statistics and charts
                            <LineBreak/><Bold>Step 6 - Validate:</Bold> QC checks and decision
                            <LineBreak/><Bold>Step 7 - Export:</Bold> Generate PDF/Excel reports
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Formula Reference -->
                <Border Style="{DynamicResource CardBorder}" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ ROV Gyro Formula" FontSize="18" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,10"/>
                        <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" 
                                   FontFamily="Consolas" LineHeight="26" FontSize="13">
                            C (Calculated Heading) = V + D + Î¸ + F
                            <LineBreak/>
                            <LineBreak/>Where:
                            <LineBreak/>  V = Vessel Heading (from vessel gyro)
                            <LineBreak/>  D = Dead reckoning offset (user configured)
                            <LineBreak/>  Î¸ = Baseline angle from USBL (measured)
                            <LineBreak/>  F = Facing direction offset:
                            <LineBreak/>      Forward = 0Â°
                            <LineBreak/>      Aft = 180Â°
                            <LineBreak/>      Port = -90Â°
                            <LineBreak/>      Starboard = +90Â°
                            <LineBreak/>
                            <LineBreak/>C-O = Calculated Heading - ROV Observed Heading
                        </TextBlock>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2" Background="{DynamicResource SurfaceBrush}" Padding="20,15">
            <Grid>
                <TextBlock Text="Fathom OS - ROV Gyro Calibration Module" 
                           Foreground="{DynamicResource TextSecondaryBrush}"
                           VerticalAlignment="Center"/>
                <Button Content="Close" HorizontalAlignment="Right" 
                        Style="{DynamicResource PrimaryButton}"
                        Click="CloseButton_Click" Width="100"/>
            </Grid>
        </Border>
    </Grid>
</mah:MetroWindow>
