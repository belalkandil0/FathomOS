<mah:MetroWindow x:Class="FathomOS.Modules.SurveyListing.Views.DxfToListingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        Title="DXF to Survey Listing Tool" Height="600" Width="900"
        WindowStartupLocation="CenterOwner"
        TitleCharacterCasing="Normal"
        GlowBrush="{DynamicResource MahApps.Brushes.Accent}"
        BorderThickness="1">
    
    <mah:MetroWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Themes/Dark.Blue.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </mah:MetroWindow.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="DXF to Survey Listing" FontSize="24" FontWeight="Light"/>
            <TextBlock Text="Extract X, Y, Z coordinates from a DXF file and generate a survey listing." 
                       Foreground="{DynamicResource SecondaryTextBrush}"/>
        </StackPanel>
        
        <!-- File Selection -->
        <Border Grid.Row="1" Background="{DynamicResource PanelBackgroundBrush}" 
                CornerRadius="4" Padding="15" Margin="0,0,0,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="DXF File" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <TextBox x:Name="TxtDxfPath" IsReadOnly="True" 
                             />
                    <TextBlock Text="⚠️ Note: Only DXF files are supported. DWG files must be converted to DXF first." 
                               Foreground="{DynamicResource SecondaryTextBrush}" 
                               FontSize="11" Margin="0,5,0,0"/>
                </StackPanel>
                
                <Button Grid.Column="1" Content="Browse..." Padding="15,5" Margin="10,15,0,0"
                        VerticalAlignment="Top" Click="BrowseDxf_Click"/>
            </Grid>
        </Border>
        
        <!-- Options -->
        <Border Grid.Row="2" Background="{DynamicResource PanelBackgroundBrush}" 
                CornerRadius="4" Padding="15" Margin="0,0,0,15">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock Text="Extraction Options" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,15"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Entity Types -->
                        <StackPanel Grid.Column="0" Margin="0,0,20,0">
                            <TextBlock Text="Entity Types to Extract:" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <CheckBox x:Name="ChkPoints" Content="Points" IsChecked="True" Margin="0,0,0,5"/>
                            <CheckBox x:Name="ChkLines" Content="Line Endpoints" IsChecked="True" Margin="0,0,0,5"/>
                            <CheckBox x:Name="ChkPolylines" Content="Polyline Vertices" IsChecked="True" Margin="0,0,0,5"/>
                            <CheckBox x:Name="ChkCircles" Content="Circle Centers" IsChecked="False" Margin="0,0,0,5"/>
                            <CheckBox x:Name="ChkArcs" Content="Arc Centers" IsChecked="False" Margin="0,0,0,5"/>
                            <CheckBox x:Name="ChkText" Content="Text Positions" IsChecked="False" Margin="0,0,0,5"/>
                        </StackPanel>
                        
                        <!-- Output Options -->
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Output Options:" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            
                            <TextBlock Text="Output Format:" Margin="0,0,0,5"/>
                            <ComboBox x:Name="CboOutputFormat" SelectedIndex="0" Margin="0,0,0,10">
                                <ComboBoxItem Content="CSV (Comma Separated)"/>
                                <ComboBoxItem Content="Tab Delimited"/>
                                <ComboBoxItem Content="Space Delimited"/>
                                <ComboBoxItem Content="Excel XLSX"/>
                            </ComboBox>
                            
                            <TextBlock Text="Coordinate Order:" Margin="0,10,0,5"/>
                            <ComboBox x:Name="CboCoordOrder" SelectedIndex="0" Margin="0,0,0,10">
                                <ComboBoxItem Content="X, Y, Z (Easting, Northing, Elevation)"/>
                                <ComboBoxItem Content="Y, X, Z (Northing, Easting, Elevation)"/>
                            </ComboBox>
                            
                            <CheckBox x:Name="ChkIncludeLayer" Content="Include Layer Name" IsChecked="True" Margin="0,5,0,5"/>
                            <CheckBox x:Name="ChkIncludeHeader" Content="Include Header Row" IsChecked="True" Margin="0,0,0,5"/>
                            <CheckBox x:Name="ChkRemoveDuplicates" Content="Remove Duplicate Points" IsChecked="True"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Layer Filter -->
                    <StackPanel Margin="0,15,0,0">
                        <TextBlock Text="Layer Filter (optional):" FontWeight="SemiBold" Margin="0,0,0,5"/>
                        <TextBox x:Name="TxtLayerFilter" 
                                 />
                    </StackPanel>
                    
                    <!-- Preview -->
                    <TextBlock Text="Preview:" FontWeight="SemiBold" Margin="0,15,0,5"/>
                    <DataGrid x:Name="PreviewGrid" Height="150" IsReadOnly="True"
                              AutoGenerateColumns="True" CanUserAddRows="False"/>
                </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- Status -->
        <Border Grid.Row="3" Background="{DynamicResource PanelBackgroundBrush}" 
                CornerRadius="4" Padding="10" Margin="0,0,0,15">
            <StackPanel Orientation="Horizontal">
                <TextBlock x:Name="TxtStatus" Text="Select a DXF file to begin..." VerticalAlignment="Center"/>
                <TextBlock x:Name="TxtPointCount" Text="" Foreground="{DynamicResource AccentBrush}" 
                           FontWeight="SemiBold" Margin="10,0,0,0" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Preview" Padding="20,8" Margin="0,0,10,0" Click="Preview_Click"/>
            <Button Content="Export..." Padding="20,8" Background="#4CAF50" Foreground="White" 
                    Margin="0,0,10,0" Click="Export_Click"/>
            <Button Content="Close" Padding="20,8" Click="Close_Click"/>
        </StackPanel>
    </Grid>
</mah:MetroWindow>
