<mah:MetroWindow x:Class="FathomOS.Modules.EquipmentInventory.Views.Dialogs.LoginDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        xmlns:converters="clr-namespace:FathomOS.Modules.EquipmentInventory.Converters"
        Title="Login - Equipment &amp; Inventory"
        Height="400" Width="400"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        ShowMinButton="False"
        ShowMaxRestoreButton="False"
        Background="{DynamicResource BackgroundBrush}"
        BorderBrush="{DynamicResource AccentBrush}"
        BorderThickness="1">
    
    <mah:MetroWindow.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibility"/>
        <converters:NullToVisibilityConverter x:Key="NullToVisibility"/>
    </mah:MetroWindow.Resources>
    
    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" HorizontalAlignment="Center" Margin="0,0,0,30">
            <iconPacks:PackIconMaterial Kind="Package" Width="50" Height="50" 
                                         Foreground="{DynamicResource AccentBrush}"
                                         HorizontalAlignment="Center"/>
            <TextBlock Text="Equipment &amp; Inventory" FontSize="18" FontWeight="Bold" 
                       HorizontalAlignment="Center" Margin="0,10,0,0"/>
            <TextBlock Text="Sign in to continue" FontSize="12" 
                       Foreground="{DynamicResource TextSecondaryBrush}"
                       HorizontalAlignment="Center"/>
        </StackPanel>
        
        <!-- Form -->
        <StackPanel Grid.Row="1">
            <TextBlock Text="Username" Style="{DynamicResource FieldLabel}"/>
            <TextBox Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}" 
                     mah:TextBoxHelper.Watermark="Enter username"
                     Margin="0,0,0,15"/>
            
            <TextBlock Text="Password" Style="{DynamicResource FieldLabel}"/>
            <PasswordBox x:Name="PasswordBox"
                         mah:TextBoxHelper.Watermark="Enter password"
                         Margin="0,0,0,15"/>
            
            <CheckBox Content="Remember me" IsChecked="{Binding RememberMe}" Margin="0,0,0,15"/>
            
            <!-- Error Message -->
            <TextBlock Text="{Binding ErrorMessage}" 
                       Foreground="{DynamicResource ErrorBrush}"
                       TextWrapping="Wrap"
                       Visibility="{Binding ErrorMessage, Converter={StaticResource NullToVisibility}}"
                       Margin="0,0,0,15"/>
        </StackPanel>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="2">
            <Button Content="Sign In" Command="{Binding LoginCommand}"
                    Style="{DynamicResource PrimaryButton}"
                    Height="40"/>
            
            <Button Content="Cancel" Command="{Binding CancelCommand}"
                    Style="{DynamicResource SecondaryButton}"
                    Height="35" Margin="0,10,0,0"/>
        </StackPanel>
        
        <!-- Loading -->
        <Border Grid.RowSpan="3" Background="#80000000" 
                Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibility}}">
            <mah:ProgressRing IsActive="True" Width="50" Height="50"/>
        </Border>
    </Grid>
</mah:MetroWindow>
