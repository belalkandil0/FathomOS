<mah:MetroWindow x:Class="FathomOS.Modules.EquipmentInventory.Views.Dialogs.QrLabelPrintDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        xmlns:converters="clr-namespace:FathomOS.Modules.EquipmentInventory.Converters"
        Title="Print QR Labels"
        Height="650" Width="950"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        ResizeMode="CanResizeWithGrip"
        Background="{DynamicResource BackgroundBrush}"
        BorderBrush="{DynamicResource AccentBrush}"
        BorderThickness="1">
    
    <mah:MetroWindow.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibility"/>
    </mah:MetroWindow.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <Grid Grid.Row="0" Margin="15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="220"/>
            </Grid.ColumnDefinitions>
            
            <!-- Available Equipment -->
            <Border Grid.Column="0" Style="{DynamicResource CardBorder}" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Available Equipment" FontWeight="Bold" Margin="0,0,0,10"/>
                    
                    <TextBox Grid.Row="1" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             mah:TextBoxHelper.Watermark="Search..." Margin="0,0,0,10"/>
                    
                    <Grid Grid.Row="2" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox Grid.Column="0" ItemsSource="{Binding Locations}" 
                                  SelectedItem="{Binding SelectedLocation}"
                                  DisplayMemberPath="Name" Margin="0,0,5,0"/>
                        <ComboBox Grid.Column="1" ItemsSource="{Binding Categories}" 
                                  SelectedItem="{Binding SelectedCategory}"
                                  DisplayMemberPath="Name" Margin="5,0,0,0"/>
                    </Grid>
                    
                    <DataGrid Grid.Row="3" ItemsSource="{Binding AvailableEquipment}"
                              SelectedItem="{Binding SelectedAvailable}"
                              AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" GridLinesVisibility="None">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Asset #" Binding="{Binding AssetNumber}" Width="100"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>
            
            <!-- Transfer Buttons -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="10">
                <Button Command="{Binding AddCommand}" ToolTip="Add Selected" Padding="10" Margin="0,0,0,5">
                    <iconPacks:PackIconMaterial Kind="ChevronRight"/>
                </Button>
                <Button Command="{Binding AddAllCommand}" ToolTip="Add All" Padding="10" Margin="0,0,0,5">
                    <iconPacks:PackIconMaterial Kind="ChevronDoubleRight"/>
                </Button>
                <Button Command="{Binding RemoveCommand}" ToolTip="Remove" Padding="10" Margin="0,0,0,5">
                    <iconPacks:PackIconMaterial Kind="ChevronLeft"/>
                </Button>
                <Button Command="{Binding ClearCommand}" ToolTip="Clear All" Padding="10">
                    <iconPacks:PackIconMaterial Kind="ChevronDoubleLeft"/>
                </Button>
            </StackPanel>
            
            <!-- Labels to Print -->
            <Border Grid.Column="2" Style="{DynamicResource CardBorder}" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Labels to Print (" FontWeight="Bold"/>
                        <TextBlock Text="{Binding LabelCount}" FontWeight="Bold"/>
                        <TextBlock Text=")" FontWeight="Bold"/>
                    </StackPanel>
                    
                    <DataGrid Grid.Row="1" ItemsSource="{Binding EquipmentToPrint}"
                              SelectedItem="{Binding SelectedToPrint}"
                              AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" GridLinesVisibility="None">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Asset #" Binding="{Binding AssetNumber}" Width="100"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                            <DataGridTextColumn Header="S/N" Binding="{Binding SerialNumber}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>
            
            <!-- Label Options -->
            <Border Grid.Column="3" Style="{DynamicResource CardBorder}" Padding="15" Margin="10,0,0,0">
                <StackPanel>
                    <TextBlock Text="LABEL OPTIONS" FontWeight="Bold" Margin="0,0,0,15"/>
                    
                    <TextBlock Text="Label Size" Style="{DynamicResource FieldLabel}"/>
                    <ComboBox ItemsSource="{Binding PresetOptions}" 
                              SelectedItem="{Binding SelectedPreset}" Margin="0,0,0,15"/>
                    
                    <TextBlock Text="Display Options" Style="{DynamicResource FieldLabel}" Margin="0,0,0,5"/>
                    <CheckBox Content="Show borders" IsChecked="{Binding ShowBorders}" Margin="0,0,0,5"/>
                    <CheckBox Content="Show name" IsChecked="{Binding ShowName}" Margin="0,0,0,5"/>
                    <CheckBox Content="Show serial number" IsChecked="{Binding ShowSerialNumber}" Margin="0,0,0,5"/>
                    <CheckBox Content="Show category" IsChecked="{Binding ShowCategory}" Margin="0,0,0,5"/>
                    <CheckBox Content="Show company name" IsChecked="{Binding ShowCompanyName}" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Company Name" Style="{DynamicResource FieldLabel}"/>
                    <TextBox Text="{Binding CompanyName}" Margin="0,0,0,20"/>
                    
                    <Button Content="Preview" Command="{Binding PreviewCommand}"
                            Style="{DynamicResource SecondaryButton}" Height="35" Margin="0,0,0,10"/>
                    
                    <Button Command="{Binding PrintCommand}" Style="{DynamicResource PrimaryButton}" Height="40">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="Printer" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="Generate PDF"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>
        </Grid>
        
        <!-- Footer -->
        <Border Grid.Row="1" Background="{DynamicResource SurfaceBrush}" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" VerticalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                
                <Button Grid.Column="1" Content="Close" Command="{Binding CloseCommand}"
                        Style="{DynamicResource SecondaryButton}" Width="100"/>
            </Grid>
        </Border>
        
        <!-- Loading -->
        <Border Grid.RowSpan="2" Background="#80000000" 
                Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibility}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <mah:ProgressRing IsActive="True" Width="50" Height="50"/>
                <TextBlock Text="Generating..." Foreground="White" Margin="0,10,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</mah:MetroWindow>
