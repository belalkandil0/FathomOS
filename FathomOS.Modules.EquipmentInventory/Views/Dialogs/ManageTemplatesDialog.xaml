<mah:MetroWindow x:Class="FathomOS.Modules.EquipmentInventory.Views.Dialogs.ManageTemplatesDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        Title="Manage Templates"
        Height="550" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        ShowInTaskbar="False"
        TitleCharacterCasing="Normal"
        BorderThickness="1"
        BorderBrush="{DynamicResource AccentBrush}"
        GlowBrush="{DynamicResource AccentBrush}">
    
    <Grid Margin="25">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                    <iconPacks:PackIconMaterial Kind="FileDocumentMultipleOutline" Width="28" Height="28" 
                                                Foreground="{DynamicResource AccentBrush}" 
                                                VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <TextBlock Text="Manage Templates" Style="{DynamicResource HeadingMedium}"/>
                </StackPanel>
                <TextBlock Text="View, edit, and delete equipment templates." 
                           Foreground="{DynamicResource TextSecondaryBrush}" FontSize="13"/>
            </StackPanel>
            
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Style="{DynamicResource SecondaryButton}" Margin="0,0,10,0"
                        Click="Export_Click" ToolTip="Export templates">
                    <StackPanel Orientation="Horizontal">
                        <iconPacks:PackIconMaterial Kind="Export" Width="16" Height="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Export"/>
                    </StackPanel>
                </Button>
                <Button Style="{DynamicResource SecondaryButton}"
                        Click="Import_Click" ToolTip="Import templates">
                    <StackPanel Orientation="Horizontal">
                        <iconPacks:PackIconMaterial Kind="Import" Width="16" Height="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Import"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
        
        <!-- Search -->
        <TextBox Grid.Row="1" x:Name="SearchBox" Margin="0,0,0,15"
                 mah:TextBoxHelper.Watermark="Search templates..."
                 mah:TextBoxHelper.ClearTextButton="True"
                 TextChanged="SearchBox_TextChanged"/>
        
        <!-- Templates Grid -->
        <DataGrid Grid.Row="2" x:Name="TemplatesGrid"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  SelectionUnit="FullRow"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  HeadersVisibility="Column"
                  GridLinesVisibility="Horizontal"
                  BorderThickness="0"
                  Background="Transparent"
                  RowBackground="{DynamicResource CardBrush}"
                  AlternatingRowBackground="{DynamicResource SurfaceBrush}"
                  SelectionChanged="TemplatesGrid_SelectionChanged">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Template Name" Binding="{Binding TemplateName}" Width="*"/>
                <DataGridTextColumn Header="Category" Binding="{Binding Category.Name}" Width="120"/>
                <DataGridTextColumn Header="Used" Binding="{Binding UsageCount}" Width="60"/>
                <DataGridTextColumn Header="Created" Binding="{Binding CreatedAt, StringFormat='{}{0:MMM dd, yyyy}'}" Width="100"/>
            </DataGrid.Columns>
        </DataGrid>
        
        <!-- Empty State -->
        <StackPanel x:Name="EmptyState" Grid.Row="2" VerticalAlignment="Center" 
                    HorizontalAlignment="Center" Visibility="Collapsed">
            <iconPacks:PackIconMaterial Kind="FileDocumentRemoveOutline" Width="48" Height="48" 
                                        Foreground="{DynamicResource TextSecondaryBrush}" 
                                        HorizontalAlignment="Center" Opacity="0.5"/>
            <TextBlock Text="No templates" FontSize="14" FontWeight="SemiBold"
                       Foreground="{DynamicResource TextSecondaryBrush}" 
                       HorizontalAlignment="Center" Margin="0,15,0,5"/>
            <TextBlock Text="Save equipment as templates to see them here"
                       Foreground="{DynamicResource TextSecondaryBrush}" FontSize="12"
                       HorizontalAlignment="Center" Opacity="0.7"/>
        </StackPanel>
        
        <!-- Buttons -->
        <Grid Grid.Row="3" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="0" x:Name="EditButton" Style="{DynamicResource SecondaryButton}"
                    Click="Edit_Click" Padding="15,10" Margin="0,0,10,0" IsEnabled="False">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Pencil" Width="16" Height="16" Margin="0,0,8,0"/>
                    <TextBlock Text="Edit"/>
                </StackPanel>
            </Button>
            <Button Grid.Column="1" x:Name="DeleteButton" Style="{DynamicResource SecondaryButton}"
                    Click="Delete_Click" Padding="15,10" IsEnabled="False">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Delete" Width="16" Height="16" Margin="0,0,8,0"/>
                    <TextBlock Text="Delete"/>
                </StackPanel>
            </Button>
            
            <Button Grid.Column="3" Content="Close" Style="{DynamicResource PrimaryButton}"
                    Click="Close_Click" Padding="25,10"/>
        </Grid>
    </Grid>
</mah:MetroWindow>
